
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  
  <title>初识MyBatis | Lyouth&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="首先我要明确告诉大家的是MyBatis是一个java持久层框架，以前我们都是用jdbc来将我们的java程序与数据库相连接，而MyBatis是对jdbc的一个封装。">
<meta name="keywords" content="mybatis">
<meta property="og:type" content="article">
<meta property="og:title" content="初识MyBatis">
<meta property="og:url" content="https://www.liuyu.in/2018/05/28/PracticeMyBatis/index.html">
<meta property="og:site_name" content="Lyouth&#39;s Blog">
<meta property="og:description" content="首先我要明确告诉大家的是MyBatis是一个java持久层框架，以前我们都是用jdbc来将我们的java程序与数据库相连接，而MyBatis是对jdbc的一个封装。">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/mybatis%E6%9E%B6%E6%9E%84.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/MyBatis%E6%89%80%E9%9C%80jar%E5%8C%85.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AEID%E6%9F%A5%E6%89%BE%E7%94%A8%E6%88%B7.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AEID%E6%9F%A5%E6%89%BE%E7%94%A8%E6%88%B7%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AE%E7%94%A8%E6%88%B7%E5%90%8D%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AE%E7%94%A8%E6%88%B7%E5%90%8D%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%B9%B6%E8%BF%94%E5%9B%9E%E4%B8%BB%E9%94%AE.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%B9%B6%E8%BF%94%E5%9B%9E%E4%B8%BB%E9%94%AE%E8%BE%93%E5%87%BA.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AEID%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7.png">
<meta property="og:image" content="http://owtr5yq3h.bkt.clouddn.com/%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7.png">
<meta property="og:updated_time" content="2018-04-27T07:31:57.477Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="初识MyBatis">
<meta name="twitter:description" content="首先我要明确告诉大家的是MyBatis是一个java持久层框架，以前我们都是用jdbc来将我们的java程序与数据库相连接，而MyBatis是对jdbc的一个封装。">
<meta name="twitter:image" content="http://owtr5yq3h.bkt.clouddn.com/mybatis%E6%9E%B6%E6%9E%84.png">
  
    <link rel="alternative" href="/atom.xml" title="Lyouth&#39;s Blog" type="application/atom+xml">
  
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
  
<script type="text/javascript">
var isWX = /micromessenger/i.test(navigator.userAgent);
if (isWX) {
  document.write('<br/><br/><h1 style="text-align: center;font-size:32px;" >╮(╯_╰)╭</h1><br/><br/><h4 style="text-align: center;" >请在浏览器中打开。</h4><br/><h4 style="text-align: center;" >Please open in the browser.</h4>');
  window.stop ? window.stop() : document.execCommand("Stop");
}
</script>


</head>

<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <nav id="upper-nav" class="inner">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <div class="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        
          <a id="nav-github" class="nav-icon" href="https://github.com/liuyu1994"></a>
        
      </div>
    </nav>
    <div id="header-title">
      
        <h1 id="blog-title-wrap">
          <a href="/" id="blog-title">Lyouth&#39;s Blog</a>
        </h1>
      
    </div>
    <div id="contenedor">
      <ul class="cube">
        <li class="cara">MyLogo</li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
      </ul>
    </div>
    <nav id="main-nav">
      
        <a class="main-nav-link" href="/">Home</a>
      
        <a class="main-nav-link" href="/archives">Archives</a>
      
        <a class="main-nav-link" href="/about">About</a>
      
      <a class="main-nav-link st-search-show-outputs">Search</a>
    </nav>
  </div>
</header>

    <div class="outer">
      <section id="main"><article id="post-PracticeMyBatis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2018/05/28/PracticeMyBatis/" class="article-date">
  <time datetime="2018-05-28T12:35:50.625Z" itemprop="datePublished">2018-05-28</time>
</h3>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mybatis/">mybatis</a>
  </div>

  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      初识MyBatis
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <p>首先我要明确告诉大家的是MyBatis是一个java持久层框架，以前我们都是用jdbc来将我们的java程序与数据库相连接，而MyBatis是对jdbc的一个封装。<br><a id="more"></a></p>
<h2 id="1-MyBatis框架的引入"><a href="#1-MyBatis框架的引入" class="headerlink" title="1.MyBatis框架的引入"></a>1.MyBatis框架的引入</h2><p>我们来看看传统的编程方式中使用jdbc的问题:</p>
<ul>
<li>1.数据库链接创建、释放频繁造成系统资源浪费从而影响系统性能，如果使用数据库链接池可解决此问题。<br><strong>解决</strong>:在SqlMapConfig.xml中配置数据链接池，使用连接池管理数据库链接。</li>
<li>2.Sql语句写在代码中造成代码不易维护，实际应用sql变化的可能较大，sql变动需要改变java代码。<br><strong>解决</strong>：将Sql语句配置在XXXXmapper.xml文件中与java代码分离。</li>
<li>3.向sql语句传参数麻烦，因为sql语句的where条件不一定，可能多也可能少，占位符需要和参数一一对应。<br><strong>解决</strong>:Mybatis自动将java对象映射至sql语句，通过statement中的parameterType定义输入参数的类型。</li>
<li>4.对结果集解析麻烦，sql变化导致解析代码变化，且解析前需要遍历，如果能将数据库记录封装成pojo对象解析比较方便。<br><strong>解决</strong>:Mybatis自动将sql执行结果映射至java对象，通过statement中的resultType定义输出结果的类型。</li>
</ul>
<h2 id="2-MyBatis介绍"><a href="#2-MyBatis介绍" class="headerlink" title="2.MyBatis介绍"></a>2.MyBatis介绍</h2><p>MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis。2013年11月迁移到Github。 </p>
<p>MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装，使开发者只需要关注SQL本身，而不需要花费精力去处理例如注册驱动、创建connection、创建statement、手动设置参数、结果集检索等jdbc繁杂的过程代码。</p>
<p>Mybatis通过xml或注解的方式将要执行的各种statement（statement、preparedStatement、CallableStatement）配置起来，并通过java对象和statement中的sql进行映射生成最终执行的sql语句，最后由mybatis框架执行sql并将结果映射成java对象并返回。</p>
<h2 id="3-Mybatis架构"><a href="#3-Mybatis架构" class="headerlink" title="3.Mybatis架构"></a>3.Mybatis架构</h2><p><img src="http://owtr5yq3h.bkt.clouddn.com/mybatis%E6%9E%B6%E6%9E%84.png" alt="MyBatis架构"></p>
<ul>
<li>1.MyBatis配置<br>SqlMapConfig.xml，此文件作为mybatis的全局配置文件，配置了mybatis的运行环境等信息。<br>mapper.xml文件即sql映射文件，文件中配置了操作数据库的sql语句。此文件需要在SqlMapConfig.xml中加载。</li>
<li>2.通过mybatis环境等配置信息构造SqlSessionFactory即会话工厂</li>
<li>3.由会话工厂创建sqlSession即会话，操作数据库需要通过sqlSession进行。</li>
<li>4.mybatis底层自定义了Executor执行器接口操作数据库，Executor接口有两个实现，一个是基本执行器、一个是缓存执行器。</li>
<li>5.Mapped Statement也是mybatis一个底层封装对象，它包装了mybatis配置信息及sql映射信息等。mapper.xml文件中一个sql对应一个Mapped Statement对象，sql的id即是Mapped statement的id。</li>
<li>6.Mapped Statement对sql执行输入参数进行定义，包括HashMap、基本类型、pojo，Executor通过Mapped Statement在执行sql前将输入的java对象映射至sql中，输入参数映射就是jdbc编程中对preparedStatement设置参数。</li>
<li>7.Mapped Statement对sql执行输出结果进行定义，包括HashMap、基本类型、pojo，Executor通过Mapped Statement在执行sql后将输出结果映射至java对象中，输出结果映射过程相当于jdbc编程中对结果的解析处理过程。</li>
</ul>
<h2 id="4-Mybatis入门程序"><a href="#4-Mybatis入门程序" class="headerlink" title="4.Mybatis入门程序"></a>4.Mybatis入门程序</h2><h3 id="4-1准备开发环境"><a href="#4-1准备开发环境" class="headerlink" title="4.1准备开发环境"></a>4.1准备开发环境</h3><p>1.创建测试项目，普通java项目或是web项目皆可</p>
<p>2.导入jar包:<br><img src="http://owtr5yq3h.bkt.clouddn.com/MyBatis%E6%89%80%E9%9C%80jar%E5%8C%85.png" alt="所需jar包"><br>3.创建数据库和相应的表,SQL脚本如下:<br>创建User表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS `user`;</span><br><span class="line">CREATE TABLE `user` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `username` varchar(32) NOT NULL COMMENT &apos;用户名称&apos;,</span><br><span class="line">  `birthday` date DEFAULT NULL COMMENT &apos;生日&apos;,</span><br><span class="line">  `sex` char(1) DEFAULT NULL COMMENT &apos;性别&apos;,</span><br><span class="line">  `address` varchar(256) DEFAULT NULL COMMENT &apos;地址&apos;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=27 DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure></p>
<p>插入数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `user` VALUES (&apos;1&apos;, &apos;王五&apos;, null, &apos;2&apos;, null);</span><br><span class="line">INSERT INTO `user` VALUES (&apos;10&apos;, &apos;张三&apos;, &apos;2014-07-10&apos;, &apos;1&apos;, &apos;北京市&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (&apos;16&apos;, &apos;张小明&apos;, null, &apos;1&apos;, &apos;河南郑州&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (&apos;22&apos;, &apos;陈小明&apos;, null, &apos;1&apos;, &apos;河南郑州&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (&apos;24&apos;, &apos;张三丰&apos;, null, &apos;1&apos;, &apos;河南郑州&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (&apos;25&apos;, &apos;陈小明&apos;, null, &apos;1&apos;, &apos;河南郑州&apos;);</span><br><span class="line">INSERT INTO `user` VALUES (&apos;26&apos;, &apos;王五&apos;, null, null, null);</span><br></pre></td></tr></table></figure></p>
<p>创建Orders表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS `orders`;</span><br><span class="line">CREATE TABLE `orders` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `user_id` int(11) NOT NULL COMMENT &apos;下单用户id&apos;,</span><br><span class="line">  `number` varchar(32) NOT NULL COMMENT &apos;订单号&apos;,</span><br><span class="line">  `createtime` datetime NOT NULL COMMENT &apos;创建订单时间&apos;,</span><br><span class="line">  `note` varchar(100) DEFAULT NULL COMMENT &apos;备注&apos;,</span><br><span class="line">  PRIMARY KEY (`id`),</span><br><span class="line">  KEY `FK_orders_1` (`user_id`),</span><br><span class="line">  CONSTRAINT `FK_orders_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure></p>
<p>插入数据:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `orders` VALUES (&apos;3&apos;, &apos;1&apos;, &apos;1000010&apos;, &apos;2015-02-04 13:22:35&apos;, null);</span><br><span class="line">INSERT INTO `orders` VALUES (&apos;4&apos;, &apos;1&apos;, &apos;1000011&apos;, &apos;2015-02-03 13:22:41&apos;, null);</span><br><span class="line">INSERT INTO `orders` VALUES (&apos;5&apos;, &apos;10&apos;, &apos;1000012&apos;, &apos;2015-02-12 16:13:23&apos;, null);</span><br></pre></td></tr></table></figure></p>
<p>4.创建日志文件<br>在classpath下创建log4j.properties如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Global logging configuration</span><br><span class="line">log4j.rootLogger=DEBUG, stdout</span><br><span class="line"># Console output...</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure></p>
<p>mybatis默认使用log4j作为输出日志信息。</p>
<p>5.创建MyBatis核心配置文件 - SqlMapConfig.xml<br>在classpath下创建SqlMapConfig.xml，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- 和spring整合后 environments配置将废除--&gt;</span><br><span class="line">    &lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">        &lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">            &lt;!-- 使用jdbc事务管理--&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">            &lt;!-- 数据库连接池--&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/sqlpractice?characterEncoding=utf-8&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;1234&quot; /&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;!--加载映射文件--&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;MyBatis/SqlMap/User.xml&quot;/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>SqlMapConfig.xml是mybatis核心配置文件，上边文件的配置内容为数据源、事务管理。</strong></p>
<p>6.创建实体类(PO)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String username; //用户姓名</span><br><span class="line">    private String sex;  //性别</span><br><span class="line">    private Date birthday; //生日</span><br><span class="line">    private String address; //地址</span><br><span class="line">    //此处省略Get/Set/ToString方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>7.创建Sql映射文件<br>在classpath下的sqlmap目录下创建sql映射文件Users.xml：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;test&quot;&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></p>
<p>namespace ：命名空间，用于隔离sql语句，后面会讲另一层非常重要的作用。<br>8.加载映射文件<br>mybatis框架需要加载映射文件，将Users.xml添加在SqlMapConfig.xml，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;mappers&gt;</span><br><span class="line">    &lt;mapper resource=&quot;MyBatis/SqlMaUser.xml&quot;/&gt;</span><br><span class="line">&lt;/mappers&gt;</span><br></pre></td></tr></table></figure></p>
<p>到此，环境搭建以及配置告一段落，目录结构如下：<br><img src="http://owtr5yq3h.bkt.clouddn.com/%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png" alt="目录结构"></p>
<h3 id="4-2根据ID查询用户信息"><a href="#4-2根据ID查询用户信息" class="headerlink" title="4.2根据ID查询用户信息"></a>4.2根据ID查询用户信息</h3><h4 id="1-在映射文件-user-xml-中添加"><a href="#1-在映射文件-user-xml-中添加" class="headerlink" title="1.在映射文件(user.xml)中添加"></a>1.在映射文件(user.xml)中添加</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--根据ID获取用户信息--&gt;</span><br><span class="line">    &lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;MyBatis.po.User&quot;&gt;</span><br><span class="line">        SELECT * FROM USER WHERE id=#&#123;id&#125;;</span><br><span class="line">    &lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p><code>parameterType</code>：定义输入到sql中的映射类型，#{id}表示使用preparedstatement设置占位符号并将输入变量id传到sql。<br><code>resultType</code>：定义结果映射类型。</p>
<h4 id="2-编写测试类进行测试"><a href="#2-编写测试类进行测试" class="headerlink" title="2.编写测试类进行测试"></a>2.编写测试类进行测试</h4><p><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AEID%E6%9F%A5%E6%89%BE%E7%94%A8%E6%88%B7.png" alt="根据ID查找用户"></p>
<p><strong>注意</strong>:测试采用junit来编写的测试类。输出结果如下:</p>
<p><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AEID%E6%9F%A5%E6%89%BE%E7%94%A8%E6%88%B7%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png" alt=""></p>
<h3 id="4-3根据用户名查询用户信息"><a href="#4-3根据用户名查询用户信息" class="headerlink" title="4.3根据用户名查询用户信息"></a>4.3根据用户名查询用户信息</h3><h4 id="1-在映射文件-user-xml-中添加-1"><a href="#1-在映射文件-user-xml-中添加-1" class="headerlink" title="1.在映射文件(user.xml)中添加"></a>1.在映射文件(user.xml)中添加</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--根据用户名获取用户信息--&gt;</span><br><span class="line">   &lt;select id=&quot;findUserByUsername&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;MyBatis.po.User&quot;&gt;</span><br><span class="line">       select * from USER WHERE username LIKE &apos;%$&#123;value&#125;%&apos;;</span><br><span class="line">   &lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p><code>parameterType</code>：定义输入到sql中的映射类型，${value}表示使用参数将${value}替换，做字符串的拼接。<br>注意：如果是取简单数量类型的参数，括号中的值必须为value<br><code>resultType</code>：定义结果映射类型。</p>
<p>此时，我们在传入参数的地方不再使用占位符<code>#{}</code>而是使用<code>${}</code>，二者区别如下:</p>
<ul>
<li><code>#{}</code>表示一个占位符号，通过#{}可以实现preparedStatement向占位符中设置值，自动进行java类型和jdbc类型转换，#{}可以有效防止sql注入。 #{}可以接收简单类型值或pojo属性值。 如果parameterType传输单个简单类型值，#{}括号中可以是value或其它名称。</li>
<li><code>${}</code>表示拼接sql串，通过<code>${}</code>可以将ParameterType 传入的内容拼接在sql中且不进行jdbc类型转换， <code>${}</code>可以接收简单类型值或pojo属性值，如果parameterType传输单个简单类型值，${}括号中只能是value。</li>
</ul>
<h4 id="2-编写测试类进行测试-1"><a href="#2-编写测试类进行测试-1" class="headerlink" title="2.编写测试类进行测试"></a>2.编写测试类进行测试</h4><p><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AE%E7%94%A8%E6%88%B7%E5%90%8D%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF.png" alt="根据用户名模糊查询用户信息"></p>
<p>输出结果：</p>
<p><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AE%E7%94%A8%E6%88%B7%E5%90%8D%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png" alt="输出结果"></p>
<h3 id="4-4添加用户-并返回主键"><a href="#4-4添加用户-并返回主键" class="headerlink" title="4.4添加用户,并返回主键"></a>4.4添加用户,并返回主键</h3><h4 id="1-在映射文件-user-xml-中添加-2"><a href="#1-在映射文件-user-xml-中添加-2" class="headerlink" title="1.在映射文件(user.xml)中添加"></a>1.在映射文件(user.xml)中添加</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--添加用户,并返回主键--&gt;</span><br><span class="line">   &lt;insert id=&quot;insertUser&quot; parameterType=&quot;MyBatis.po.User&quot;&gt;</span><br><span class="line">       &lt;!-- selectKey将主键返回，需要再返回 --&gt;</span><br><span class="line">       &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">           select LAST_INSERT_ID()</span><br><span class="line">       &lt;/selectKey&gt;</span><br><span class="line">     INSERT INTO USER (username,birthday,sex,address) VALUES (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;);</span><br><span class="line">   &lt;/insert&gt;</span><br></pre></td></tr></table></figure>
<p><strong>添加selectKey实现将主键返回</strong><br><code>keyProperty</code>:返回的主键存储在pojo中的哪个属性<br><code>order</code>：selectKey的执行顺序，是相对与insert语句来说，由于mysql的自增原理执行完insert语句之后才将主键生成，所以这里selectKey的执行顺序为<code>after</code><br><code>resultType</code>:返回的主键是什么类型<br><code>LAST_INSERT_ID()</code>:是mysql的函数，返回auto_increment自增列新记录id值。</p>
<p><strong>拓展</strong>:Mysql使用 uuid实现主键<br>需要增加通过select uuid()得到uuid值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert  id=&quot;insertUser&quot; parameterType=&quot;MyBatis.po.User&quot;&gt;</span><br><span class="line">&lt;selectKey resultType=&quot;java.lang.String&quot; order=&quot;BEFORE&quot; </span><br><span class="line">keyProperty=&quot;id&quot;&gt;</span><br><span class="line">select uuid()</span><br><span class="line">&lt;/selectKey&gt;</span><br><span class="line">insert into user(id,username,birthday,sex,address) </span><br><span class="line">		 values(#&#123;id&#125;,#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">&lt;/insert&gt;</span><br><span class="line">//注意这里使用的order是“BEFORE”</span><br></pre></td></tr></table></figure></p>
<h4 id="2-编写测试类进行测试-2"><a href="#2-编写测试类进行测试-2" class="headerlink" title="2.编写测试类进行测试"></a>2.编写测试类进行测试</h4><p><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%B9%B6%E8%BF%94%E5%9B%9E%E4%B8%BB%E9%94%AE.png" alt="添加用户并返回主键"></p>
<p>输出结果：<br><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%B9%B6%E8%BF%94%E5%9B%9E%E4%B8%BB%E9%94%AE%E8%BE%93%E5%87%BA.png" alt="输出结果"></p>
<h3 id="4-5根据ID删除用户"><a href="#4-5根据ID删除用户" class="headerlink" title="4.5根据ID删除用户"></a>4.5根据ID删除用户</h3><h4 id="1-在映射文件-user-xml-中添加-3"><a href="#1-在映射文件-user-xml-中添加-3" class="headerlink" title="1.在映射文件(user.xml)中添加"></a>1.在映射文件(user.xml)中添加</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--删除用户--&gt;</span><br><span class="line">   &lt;delete id=&quot;deleteUserById&quot; parameterType=&quot;int&quot;&gt;</span><br><span class="line">       DELETE  FROM USER WHERE id=#&#123;id&#125;;</span><br><span class="line">   &lt;/delete&gt;</span><br></pre></td></tr></table></figure>
<h4 id="2-编写测试类进行测试-3"><a href="#2-编写测试类进行测试-3" class="headerlink" title="2.编写测试类进行测试"></a>2.编写测试类进行测试</h4><p><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%A0%B9%E6%8D%AEID%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7.png" alt="删除用户"></p>
<p>运行程序后便可发现数据库中的该数据已被删除。</p>
<h3 id="4-6更新用户"><a href="#4-6更新用户" class="headerlink" title="4.6更新用户"></a>4.6更新用户</h3><h4 id="1-在映射文件-user-xml-中添加-4"><a href="#1-在映射文件-user-xml-中添加-4" class="headerlink" title="1.在映射文件(user.xml)中添加"></a>1.在映射文件(user.xml)中添加</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--更新用户--&gt;</span><br><span class="line">   &lt;update id=&quot;updateUser&quot; parameterType=&quot;MyBatis.po.User&quot;&gt;</span><br><span class="line">     UPDATE USER SET username=#&#123;username&#125;,birthday=#&#123;birthday&#125;,sex=#&#123;sex&#125;,address=#&#123;address&#125; where id=#&#123;id&#125;;</span><br><span class="line">   &lt;/update&gt;</span><br></pre></td></tr></table></figure>
<h4 id="2-编写测试类进行测试-4"><a href="#2-编写测试类进行测试-4" class="headerlink" title="2.编写测试类进行测试"></a>2.编写测试类进行测试</h4><p><img src="http://owtr5yq3h.bkt.clouddn.com/%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7.png" alt="更新用户"></p>
<p>运行程序后便可发现数据库中的该数据已被更新。</p>
<h2 id="5-小结"><a href="#5-小结" class="headerlink" title="5.小结"></a>5.小结</h2><h3 id="5-1-parameterType和resultType"><a href="#5-1-parameterType和resultType" class="headerlink" title="5.1 parameterType和resultType"></a>5.1 parameterType和resultType</h3><ul>
<li>parameterType：指定输入参数类型，mybatis通过ognl从输入对象中获取参数值拼接在sql中。</li>
<li>resultType：指定输出结果类型，mybatis将sql查询结果的一行记录数据映射为resultType指定类型的对象。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mybatis/">mybatis</a></li></ul>

        <a data-url="https://www.liuyu.in/2018/05/28/PracticeMyBatis/" data-id="cjhq8kwsf000ucguk0dld0nsp" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/05/28/PracticeJDBC/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Java学习笔记之JDBC
        
      </div>
    </a>
  
  
    <a href="/2018/05/28/MyBatisMappered/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">MyBatis输入映射和输出映射</div>
    </a>
  
</nav>

  
</article>


</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/05/28/PracticeMysql/">MySQL语法查漏补缺</a>
          </li>
        
          <li>
            <a href="/2018/05/28/PracticeSpringMvc/">Spring MVC快速入门(一)</a>
          </li>
        
          <li>
            <a href="/2018/05/28/PracticeJDBC/">Java学习笔记之JDBC</a>
          </li>
        
          <li>
            <a href="/2018/05/28/PracticeMyBatis/">初识MyBatis</a>
          </li>
        
          <li>
            <a href="/2018/05/28/MyBatisMappered/">MyBatis输入映射和输出映射</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Mvc/">Spring Mvc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdbc/">jdbc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/">mybatis</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Liuyu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/sun11/hexo-theme-paperbox" target="_blank">Paperbox</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
  <a href="#search" class="mobile-nav-link st-search-show-outputs">Search</a>
</nav>
  

<!-- totop start -->
<div id="totop">
	<a title="To Top"></a>
</div>
<!-- totop end -->

<!-- swiftype search start -->

<!-- swiftype search end -->



<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/lrsjng.jquery-qrcode/0.12.0/jquery.qrcode.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

</div>
</body>
</html>
